name: Deploy Auth0

on:
  push:
    branches:
      - master
    paths:
      - "auth0/**/*.tf"
      - .github/workflows/deploy-auth0.yaml
      - .github/workflows/_terraform.yaml

  pull_request:
    paths:
      - "auth0/**/*.tf"
      - .github/workflows/deploy-auth0.yaml
      - .github/workflows/_terraform.yaml

permissions:
  pull-requests: write

jobs:
  terraform:
    name: Terraform

    uses: ./.github/workflows/_terraform.yaml
    with:
      workspace: auth0

    secrets:
      TERRAFORM_TOKEN: ${{ secrets.TERRAFORM_TOKEN }}
